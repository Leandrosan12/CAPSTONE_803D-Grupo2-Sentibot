{% extends "base.html" %}
{% load static %}

{% block title %}Emociones Interactivas{% endblock %}

{% block content %}
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

<style>
body {
    background: linear-gradient(to bottom, #f5f7fa, #e9f0f7);
    font-family: 'Segoe UI', sans-serif;
}
h1 { font-weight:700; color:#2c3e50; margin-bottom:40px; text-align:center; }

.emotion-card {
    border-radius: 20px;
    box-shadow: 0 8px 20px rgba(0,0,0,0.15);
    transition: all 0.3s ease;
    cursor: pointer;
    background: #fff;
    padding: 30px 20px;
    text-align: center;
}
.emotion-card:hover {
    transform: translateY(-8px) scale(1.05);
    box-shadow: 0 12px 30px rgba(0,0,0,0.2);
}
.emotion-icon { font-size: 5rem; margin-bottom: 15px; }
.card-title { font-weight:700; font-size:1.4rem; color:#34495e; }

.section { display:none; margin-top:50px; }

.question-card {
    background:#fff;
    border-radius:20px;
    padding:30px;
    box-shadow:0 8px 20px rgba(0,0,0,0.1);
    max-width:700px;
    margin:0 auto;
}
.opcion-btn {
    border-radius:15px;
    font-weight:600;
    padding:12px 25px;
    transition:all 0.2s;
}
.opcion-btn:hover {
    transform:scale(1.05);
}

.result-card {
    background: #fff;
    border-radius: 20px;
    padding:25px;
    box-shadow: 0 8px 20px rgba(0,0,0,0.15);
    text-align:center;
    margin-top:20px;
}
.result-card h4 { color:#0d6efd; font-weight:700; margin-bottom:15px; }
.recommendations {
    margin-top:20px;
    display:flex;
    flex-wrap:wrap;
    gap:15px;
    justify-content:center;
}
.recommendation-card {
    background:#f8f9fa;
    border-left:5px solid #007bff;
    border-radius:15px;
    padding:15px 20px;
    display:flex;
    align-items:center;
    min-width:200px;
    transition:all 0.2s;
}
.recommendation-card:hover {
    transform:translateY(-5px);
    box-shadow:0 6px 15px rgba(0,0,0,0.1);
}
.recommendation-card span { font-size:1.8rem; margin-right:15px; }
</style>

<div class="container my-5">
    <h1>🌈 Descubre tu Estado Emocional</h1>

    <div class="row g-4 justify-content-center">
        <div class="col-md-4 col-lg-2">
            <div class="emotion-card" onclick="iniciarTest('Alegría')">
                <div class="emotion-icon">😄</div>
                <h5 class="card-title">Alegría</h5>
            </div>
        </div>
        <div class="col-md-4 col-lg-2">
            <div class="emotion-card" onclick="iniciarTest('Tristeza')">
                <div class="emotion-icon">😢</div>
                <h5 class="card-title">Tristeza</h5>
            </div>
        </div>
        <div class="col-md-4 col-lg-2">
            <div class="emotion-card" onclick="iniciarTest('Miedo')">
                <div class="emotion-icon">😨</div>
                <h5 class="card-title">Miedo</h5>
            </div>
        </div>
        <div class="col-md-4 col-lg-2">
            <div class="emotion-card" onclick="iniciarTest('Enojo')">
                <div class="emotion-icon">😡</div>
                <h5 class="card-title">Enojo</h5>
            </div>
        </div>
        <div class="col-md-4 col-lg-2">
            <div class="emotion-card" onclick="iniciarTest('Asco')">
                <div class="emotion-icon">🤢</div>
                <h5 class="card-title">Asco</h5>
            </div>
        </div>
        <div class="col-md-4 col-lg-2">
            <div class="emotion-card" onclick="iniciarTest('Neutral')">
                <div class="emotion-icon">😐</div>
                <h5 class="card-title">Neutral</h5>
            </div>
        </div>
    </div>
</div>

<!-- Sección Test -->
<div id="testSection" class="section container">
    <div class="question-card text-start">
        <h4 id="emocionSeleccionada"></h4>
        <div id="preguntaTexto" class="mb-3 fs-5 fw-semibold"></div>
        <div id="opcionesContainer" class="d-grid gap-2"></div>
    </div>
    <div id="resultadoDiv" class="result-card" style="display:none;">
        <h4 id="emocionFinal"></h4>
        <p id="significado"></p>
        <div class="recommendations" id="recomendaciones"></div>
    </div>
</div>

<script>
const tests = {
    "Alegría": [
        "¿Te sientes motivado/a para realizar tus actividades diarias?",
        "¿Disfrutas compartir momentos con otras personas?",
        "¿Te resulta fácil encontrar algo positivo en situaciones difíciles?",
        "¿Sueles dedicar tiempo a tus hobbies o pasatiempos favoritos?",
        "¿Te sientes satisfecho/a con los logros recientes que has tenido?"
    ],
    "Tristeza": [
        "¿Te sientes abatido/a durante el día?",
        "¿Necesitas apoyo de otras personas para sentirte mejor?",
        "¿Tienes dificultad para disfrutar tus actividades habituales?",
        "¿Prefieres estar solo/a para reflexionar?",
        "¿Te sientes decaído/a o sin energía?"
    ],
    "Miedo": [
        "¿Te sientes inseguro/a o ansioso/a actualmente?",
        "¿Evitas ciertas situaciones por temor?",
        "¿Tu mente se llena de preocupaciones frecuentes?",
        "¿Sientes tensión o nerviosismo en tu cuerpo?",
        "¿Sientes que necesitas protección o seguridad extra?"
    ],
    "Enojo": [
        "¿Te irritas fácilmente hoy?",
        "¿Sientes frustración por situaciones recientes?",
        "¿Te cuesta controlar tus impulsos?",
        "¿Quieres expresar tu enojo de alguna manera?",
        "¿Notas tensión física al estar enojado/a?"
    ],
    "Asco": [
        "¿Te sientes incómodo/a con algo que viste o experimentaste?",
        "¿Evitas ciertas personas o situaciones desagradables?",
        "¿Notas aversión hacia alimentos, olores o ambientes?",
        "¿Sientes rechazo ante algo específico?",
        "¿Deseas alejarte de lo que te incomoda?"
    ],
    "Neutral": [
        "¿Tu día ha sido rutinario sin grandes emociones?",
        "¿No sientes ni felicidad ni tristeza predominante?",
        "¿Te encuentras en un estado equilibrado emocionalmente?",
        "¿Tus decisiones hoy han sido calmadas y meditadas?",
        "¿Sientes estabilidad en tu ánimo?"
    ]
};

const significados = {
    "Alegría": "Energía alta, apertura social",
    "Tristeza": "Necesidad de apoyo o descanso",
    "Miedo": "Necesidad de seguridad o calma",
    "Enojo": "Necesidad de desahogo o justicia",
    "Asco": "Necesidad de distancia o límites",
    "Neutral": "Estado equilibrado y estable"
};

const recomendaciones = {
    "Alegría": [
        {icon:"🎶", text:"Escucha tu música favorita"},
        {icon:"🏃‍♂️", text:"Sal a caminar al aire libre"},
        {icon:"📖", text:"Comparte momentos positivos"}
    ],
    "Tristeza": [
        {icon:"📝", text:"Escribe tus sentimientos"},
        {icon:"💬", text:"Habla con alguien de confianza"},
        {icon:"🎨", text:"Realiza algo creativo"}
    ],
    "Miedo": [
        {icon:"🧘‍♂️", text:"Practica respiración profunda"},
        {icon:"📚", text:"Infórmate para sentir seguridad"},
        {icon:"🛋️", text:"Busca un lugar tranquilo y seguro"}
    ],
    "Enojo": [
        {icon:"🏃‍♀️", text:"Haz ejercicio físico"},
        {icon:"🖌️", text:"Canaliza la emoción creativamente"},
        {icon:"💨", text:"Respira profundamente y relájate"}
    ],
    "Asco": [
        {icon:"🧼", text:"Mantente alejado de lo que incomoda"},
        {icon:"🧘‍♀️", text:"Práctica mindfulness"},
        {icon:"📖", text:"Realiza actividades agradables"}
    ],
    "Neutral": [
        {icon:"📚", text:"Lee un libro interesante"},
        {icon:"☕", text:"Tómate un momento para ti"},
        {icon:"🧘‍♀️", text:"Medita o practica mindfulness"}
    ]
};

let indicePregunta = 0;
let respuestas = [];
let emocionActual = "";

function iniciarTest(emocion){
    emocionActual = emocion;
    indicePregunta = 0;
    respuestas = [];
    document.getElementById('emocionSeleccionada').textContent = "Emoción seleccionada: " + emocion;
    document.getElementById('testSection').style.display = "block";
    document.getElementById('resultadoDiv').style.display = "none";
    mostrarPregunta();
    window.scrollTo({top:0, behavior:'smooth'});
}

function mostrarPregunta(){
    const preguntas = tests[emocionActual];
    if(indicePregunta < preguntas.length){
        document.getElementById('preguntaTexto').textContent = preguntas[indicePregunta];
        const container = document.getElementById('opcionesContainer');
        container.innerHTML = '';
        ["Sí","No"].forEach(op => {
            const btn = document.createElement('button');
            btn.className = "btn btn-outline-primary opcion-btn";
            btn.textContent = op;
            btn.onclick = () => seleccionarRespuesta(op);
            container.appendChild(btn);
        });
    } else {
        mostrarResultado();
    }
}

function seleccionarRespuesta(respuesta){
    respuestas.push(respuesta);
    indicePregunta++;
    mostrarPregunta();
}

function mostrarResultado(){
    document.getElementById('preguntaTexto').textContent = '';
    document.getElementById('opcionesContainer').innerHTML = '';
    document.getElementById('resultadoDiv').style.display = 'block';
    document.getElementById('emocionFinal').textContent = "Tu emoción predominante es: " + emocionActual;
    document.getElementById('significado').textContent = significados[emocionActual];

    const cont = document.getElementById('recomendaciones');
    cont.innerHTML = '';
    recomendaciones[emocionActual].forEach(r => {
        const div = document.createElement('div');
        div.className = "recommendation-card";
        div.innerHTML = `<span>${r.icon}</span>${r.text}`;
        cont.appendChild(div);
    });

    window.scrollTo({top:0, behavior:'smooth'});
}
</script>
{% endblock %}
