{% extends "base.html" %}
{% load static %}

{% block title %}Módulo{% endblock %}

{% block content %}
<link rel="stylesheet" href="{% static '/css/modulo.css' %}">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<div class="container my-4">
  <!-- PANTALLA 1: Módulos -->
  <section id="screen-modulos" class="screen active">
    <h3 class="mb-4 text-center text-primary">Módulos</h3>
    <div class="row g-4 justify-content-center">
      <div class="col-md-4">
        <div class="mod-card" style="background-image: url({% static 'img/fondo_modulo1.jpg' %});">
          <div class="mod-overlay"></div>
          <div class="mod-content d-flex flex-column align-items-center justify-content-center h-100 text-center">
            <h4>Alumnos</h4>
            <p class="mb-3">Accede al módulo de alumnos</p>
            <button class="btn btn-ingresar" onclick="showScreen('screen-listado')">Ingresar</button>
          </div>
        </div>
      </div>
      <div class="col-md-4">
        <div class="mod-card" style="background-image: url({% static 'img/fondo_modulo2.jpg' %});">
          <div class="mod-overlay"></div>
          <div class="mod-content d-flex flex-column align-items-center justify-content-center h-100 text-center">
            <h4>Escuelas</h4>
            <p class="mb-3">Accede al módulo de escuelas</p>
            <button class="btn btn-ingresar" onclick="alert('Aquí iría el módulo Escuelas')">Ingresar</button>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- PANTALLA 2: Listado de alumnos -->
  <section id="screen-listado" class="screen">
    <div class="d-flex justify-content-between align-items-center mb-3">
      <h3>Listado de Alumnos</h3>
      <button class="btn btn-outline-secondary" onclick="showScreen('screen-modulos')">Volver</button>
    </div>

    <div class="input-group mb-3 shadow-sm">
      <input id="rutSearch" type="text" class="form-control" placeholder="Buscar por RUT">
      <button class="btn btn-primary" type="button" onclick="filterTable()">Buscar</button>
    </div>

    <div class="table-responsive">
      <table id="alumnosTable" class="table table-striped table-hover align-middle">
        <thead class="table-dark">
          <tr>
            <th>Rut</th><th>Nombre</th><th>Sede</th><th>Edad</th><th>Correo</th><th>Teléfono</th><th></th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>20.567.786-3</td>
            <td>Ana Soto</td>
            <td>Melipilla</td>
            <td>24</td>
            <td>ana.sot@duocuc.cl</td>
            <td>+569 91234567</td>
            <td><button class="btn btn-success btn-sm" onclick="openDetalle('20.567.786-3','Ana Soto','Melipilla','ana.sot@duocuc.cl')">Ver</button></td>
          </tr>
          <tr>
            <td>21.174.432-K</td>
            <td>Fabián Jaula</td>
            <td>Santiago</td>
            <td>23</td>
            <td>fabian.ja@duocuc.cl</td>
            <td>+569 83301237</td>
            <td><button class="btn btn-success btn-sm" onclick="openDetalle('21.174.432-K','Fabian Jaula','Santiago','fabian.ja@duocuc.cl')">Ver</button></td>
          </tr>
        </tbody>
      </table>
    </div>
  </section>

  <!-- PANTALLA 3: Detalle Alumno -->
  <section id="screen-detalle" class="screen">
    <div class="d-flex justify-content-between align-items-center mb-3">
      <h3>Detalle del Alumno</h3>
      <button class="btn btn-outline-secondary" onclick="showScreen('screen-listado')">Volver</button>
    </div>

    <div class="mod-card mb-4" style="background-image: url({% static 'img/fondo_detalle.jpg' %}); min-height: 200px;">
      <div class="mod-overlay"></div>
      <div class="mod-content d-flex align-items-center justify-content-between">
        <div class="d-flex align-items-center text-white">
          <img id="detalleAvatar" class="avatar-circle me-3" src="{% static 'Icon/avatar.png' %}" alt="Avatar Alumno">
          <div>
            <h4 id="detalleNombre">Nombre Apellido</h4>
            <p class="mb-1"><strong>Sede:</strong> <span id="detalleSede">-</span></p>
            <p class="mb-1"><strong>Correo:</strong> <span id="detalleCorreo">-</span></p>
            <p class="mb-0"><strong>Rut:</strong> <span id="detalleRut">-</span></p>
          </div>
        </div>
      </div>
    </div>

    <!-- Gráficos -->
    <div class="row g-4">
      <div class="col-md-6">
        <div class="chart-card">
          <h5>Emociones (Pastel)</h5>
          <div class="chart-wrapper">
            <canvas id="chartEmociones"></canvas>
          </div>
        </div>
      </div>
      <div class="col-md-6">
        <div class="chart-card">
          <h5>Estados (Radar)</h5>
          <div class="chart-wrapper">
            <canvas id="chartEstados"></canvas>
          </div>
        </div>
      </div>
    </div>
  </section>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="{% static '/js/modulo.js' %}"></script>
{% endblock %}
